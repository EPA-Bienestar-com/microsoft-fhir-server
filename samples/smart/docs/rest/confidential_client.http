# .SUMMARY Sample requests to test local SMART auth proxy

@baseUrl = {{$dotenv BASE_URL}}
@clientId = {{$dotenv CLIENT_ID}}
@clientSecret = {{$dotenv CLIENT_SECRET}}
@redirectUri = {{$dotenv REDIRECT_URI}}
@scope = launch/patient fhirUser patient/AllergyIntolerance.read patient/CarePlan.read patient/CareTeam.read patient/Condition.read patient/Device.read patient/DiagnosticReport.read patient/DocumentReference.read patient/Encounter.read patient/Goal.read patient/Immunization.read patient/MedicationRequest.read patient/Observation.read patient/Organization.read patient/Patient.read patient/Practitioner.read patient/Procedure.read patient/Provenance.read patient/PractitionerRole.read offline_access openid
@codeChallenge = ECgEuvKylvpiOS9pF2pfu5NKoBErrx8fAWdneyiPT2E
@codeVerifier = faae52a66a7ff080b275b7f4e59c2b3eec3d56d69ac036228393e16c
@audience ={{$dotenv AUDIENCE}}

### Test rest client
# @no-redirect

GET {{baseUrl}}/authorize?client_id={{clientId}}&response_type=code&redirect_uri={{redirectUri}}&response_mode=query&scope={{scope}}&state=12345&code_challenge={{codeChallenge}}&code_challenge_method=S256&aud={{audience}}

#COPY THIS RESOLVED LINK INTO A BROWSER. COPY OUT THE CODE TO THE BELOW VARIABLE.
@url = {{baseUrl}}/authorize?client_id={{clientId}}&response_type=code&redirect_uri={{redirectUri}}&response_mode=query&scope={{scope}}&state=12345&code_challenge={{codeChallenge}}&code_challenge_method=S256&aud={{audience}}


###

@authorizationCode = 0.AQEAIsMpoq4d9EiZmZlztIB81K3mwqXU40NCrSerarvNma8aAJI.AgABAAIAAAD--DLA3VO7QrddgJg7WevrAgDs_wQA9P-StNF7N8Wcto81ZA_JSSOBsNgIvm5GD0DOULCtyObS-WeqnHgNAZTM5DVKNqmO8OKbZNdpKUJusqUR9GRltfp4X4U_WwXEZY_FZJarALbsUIRIhSHummEjQ0oZLnR2OnlGWVmqa2J5Vv8IS6lBjCPhtkE44h-zmY8kdJ8Le-lSAmx6EBGr-jikXLXH9TK5iEz1DRo9kn2AGOWtXMB28EviAjkZ7gucR9P9VT4OFLaBf4hxAHvRvnD1aMfRRS7UaZzUW2BNCyjHVvYtignzpSoCR7w1sKMwD9DJONBaNBlZDB19waFlnLqn-AzIi4z1i9OitlYoeswak-nGU0WQ1YTsu4Ycs2vVbQFFv56FhCLBddNSx00KxwCPD3uYLB3QF6VsZ4mtR1wx9K1vcHRMlOiR3n0vDFpetxN7584hrw1MD2GAtiBoPq8mB-8h7XGsTDAsChtPzfn3tiRkSPASksXPHoxSZ6rAeGEZmQt7EXSe7yg9hZ077_mSRGpQaNJRtFf-UusRshPcwVYGML4PX4HikN5PiQ38gTRnI6L58AkE6qN7Uc5v7XbuZCGsWtJBZgqs4VTrBJuf-7W22lyk-OQUJSKKYtq__arfMA5ilEui2lp7WNR8Vqfs3w_7uqsjrdMVe2WksRyxttvP6ptkIklDla41QMlVVBdW53EzGosWuy6o9fN6q5X28YDYmvimMVXmE7WGgPx_XMiyZyXhcqsNjJ6x4axpU39C4h9pPpMdAaH32qmgV6IyJr_OJtXy-OK0Gjso1040hp2VVEfE9ukhrb-0Hxy55ZPg7kI1gvP8blLuox6QjQNKWMnH3LTkql6UwT8QSegK2fNIGsvMRDkCvqSWd4beKwffWEnBZ7qTld5z4ZiGg_ZJ5r2TpZHcJRiFIQA5HnZUckdvqke0ZlYjPxIzgMVe7J9qxJoLLacAA4JdEphLaPPd0iLchjHMUTVfhND9Lf1BKzyzjY4SoQXgje1xVheWPm17bLNpeh28QUBv4ja-d3DvwWc4lcmHEMKf1eQLKaUmvACpCLuPoHpRfIGqLjvPmhMs3SmmncNYRFh80LRNhzE-m8D749AJtrbVlsLRaAgnKv-ouSgeTUwm2JIiOIPnS-7uU1aIuXF9ZnQ-FM7rCMZvaCkpoHkl0X3RXV27MmPQ7zslIRo32nOhCpZXT91ZbFSzhx65wZk-hD-O2duVNuaqQH8-G4WzAiyiSrLxJuCFA219mo0zgjk7HUwA2cjpPlJkK5VXjLxSNFeq8Vkyn844SrDxQ9TYCC0qz0iDdllwm4oca8OUzvJJxSDB6QjR56ns7g-_183gBmC589lmyrjmBlO8DT1--C54ysCm2hZmw9wm1gbrNnZffcAERgr6Jfw6RJEHn67OexMZxiQguJzMdoPDs1R9OI2TXCidhVT6iUiUiJgn0Z8f8ClAuAOI1vT8JtsewxPEkXyd9EflcwBo6c0w3jM1a7bdsL-ETlmSC2NLbxbtR56C_w
POST {{baseUrl}}/token
Content-Type: application/x-www-form-urlencoded
Authorization: Basic {{clientId}} {{clientSecret}}
User-Agent: Faraday v1.10.2

&code={{authorizationCode}}
&redirect_uri=http%3A%2F%2Flocalhost
&grant_type=authorization_code
&code_verifier={{codeVerifier}}

### Refresh

@refresh_token = xxx

POST {{baseUrl}}/token
Content-Type: application/x-www-form-urlencoded
Authorization: Basic {{clientId}} {{clientSecret}}
User-Agent: Faraday v1.10.2

&refresh_token={{refresh_token}}
&scope={{scope}}
&grant_type=refresh_token
&code_verifier={{codeVerifier}}